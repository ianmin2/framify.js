'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&'function'==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};angular.module('framify.js',['ui.router','framify-paginate','ngStorage','jsonFormatter','chart.js']).service('app',['$http',function(c){var _this=this,g=window.location.href.split('/').filter(function(m){return''!=m&&'http:'!=m&&'https:'!=m});//!SETUP THE APPLICATION BASICS
//! APP CONFIGURATIONS
this.ip=g[0].split(':')[0],this.port=g[0].split(':')[1],this.hlink='http://'+this.ip+':'+this.port;var h=this.hlink;this.nav=[],c.get('config/app-routes.json').then(function(m){200==m.status?this.url=m.data:this.notify('Failed to set routes','danger')}),this.url=this.hlink,this.upload=function(m,n){return new Promise(function(o,p){//* create a formdata object
var q=new FormData;//* add the defined keys to the formdata object
for(var s in m)q.append(s,m[s]);;//* post the data to the /upload route of the running server
c.post(h+'/upload/'+n,q,{transformRequest:angular.identity,//* ensure automatic content-type settng
headers:{'Content-Type':void 0}}).then(function(t){return o(t)})})},this.clone=function(m){//* ensure that the object is defined
if(null==m||'object'!=('undefined'==typeof m?'undefined':_typeof(m)))return m;//* call the object constructor prototype
var n=m.constructor();//* clone all attributes of the parent object into a new object
for(var o in m)m.hasOwnProperty(o)&&(n[o]=m[o]);//* return the newly created object
return n},this.parseInt=function(m){return parseInt(m)},this.doNothing=function(){return Promise.resolve()},this.notify=function(m,n,o){return UIkit.notify({message:m||'A blank notification was triggered.',status:n||'info',timeout:o||6000,pos:'top-center'}),Promise.resolve(!0)};var j=this.notify;this.countries=[{name:'Afghanistan',value:'1'},{name:'Albania',value:'2'},{name:'Algeria',value:'3'},{name:'American Samoa',value:'4'},{name:'Andorra',value:'5'},{name:'Angola',value:'6'},{name:'Anguilla',value:'7'},{name:'Antarctica',value:'8'},{name:'Antigua and Barbuda',value:'9'},{name:'Argentina',value:'10'},{name:'Armenia',value:'11'},{name:'Aruba',value:'12'},{name:'Australia',value:'13'},{name:'Austria',value:'14'},{name:'Azerbaijan',value:'15'},{name:'Bahamas',value:'16'},{name:'Bahrain',value:'17'},{name:'Bangladesh',value:'18'},{name:'Barbados',value:'19'},{name:'Belarus',value:'20'},{name:'Belgium',value:'21'},{name:'Belize',value:'22'},{name:'Benin',value:'23'},{name:'Bermuda',value:'24'},{name:'Bhutan',value:'25'},{name:'Bolivia',value:'26'},{name:'Bosnia and Herzegowina',value:'27'},{name:'Botswana',value:'28'},{name:'Bouvet Island',value:'29'},{name:'Brazil',value:'30'},{name:'British Indian Ocean Territory',value:'31'},{name:'Brunei Darussalam',value:'32'},{name:'Bulgaria',value:'33'},{name:'Burkina Faso',value:'34'},{name:'Burundi',value:'35'},{name:'Cambodia',value:'36'},{name:'Cameroon',value:'37'},{name:'Canada',value:'38'},{name:'Cape Verde',value:'39'},{name:'Cayman Islands',value:'40'},{name:'Central African Republic',value:'41'},{name:'Chad',value:'42'},{name:'Chile',value:'43'},{name:'China',value:'44'},{name:'Christmas Island',value:'45'},{name:'Cocos (Keeling) Islands',value:'46'},{name:'Colombia',value:'47'},{name:'Comoros',value:'48'},{name:'Congo',value:'49'},{name:'Congo, the Democratic Republic of the',value:'50'},{name:'Cook Islands',value:'51'},{name:'Costa Rica',value:'52'},{name:'Cote d\'Ivoire',value:'53'},{name:'Croatia (Hrvatska)',value:'54'},{name:'Cuba',value:'55'},{name:'Cyprus',value:'56'},{name:'Czech Republic',value:'57'},{name:'Denmark',value:'58'},{name:'Djibouti',value:'59'},{name:'Dominica',value:'60'},{name:'Dominican Republic',value:'61'},{name:'East Timor',value:'62'},{name:'Ecuador',value:'63'},{name:'Egypt',value:'64'},{name:'El Salvador',value:'65'},{name:'Equatorial Guinea',value:'66'},{name:'Eritrea',value:'67'},{name:'Estonia',value:'68'},{name:'Ethiopia',value:'69'},{name:'Falkland Islands (Malvinas)',value:'70'},{name:'Faroe Islands',value:'71'},{name:'Fiji',value:'72'},{name:'Finland',value:'73'},{name:'France',value:'74'},{name:'France Metropolitan',value:'75'},{name:'French Guiana',value:'76'},{name:'French Polynesia',value:'77'},{name:'French Southern Territories',value:'78'},{name:'Gabon',value:'79'},{name:'Gambia',value:'80'},{name:'Georgia',value:'81'},{name:'Germany',value:'82'},{name:'Ghana',value:'83'},{name:'Gibraltar',value:'84'},{name:'Greece',value:'85'},{name:'Greenland',value:'86'},{name:'Grenada',value:'87'},{name:'Guadeloupe',value:'88'},{name:'Guam',value:'89'},{name:'Guatemala',value:'90'},{name:'Guinea',value:'91'},{name:'Guinea-Bissau',value:'92'},{name:'Guyana',value:'93'},{name:'Haiti',value:'94'},{name:'Heard and Mc Donald Islands',value:'95'},{name:'Holy See (Vatican City State)',value:'96'},{name:'Honduras',value:'97'},{name:'Hong Kong',value:'98'},{name:'Hungary',value:'99'},{name:'Iceland',value:'100'},{name:'India',value:'101'},{name:'Indonesia',value:'102'},{name:'Iran (Islamic Republic of)',value:'103'},{name:'Iraq',value:'104'},{name:'Ireland',value:'105'},{name:'Israel',value:'106'},{name:'Italy',value:'107'},{name:'Jamaica',value:'108'},{name:'Japan',value:'109'},{name:'Jordan',value:'110'},{name:'Kazakhstan',value:'111'},{name:'Kenya',value:'112'},{name:'Kiribati',value:'113'},{name:'Korea, Democratic People\'s Republic of',value:'114'},{name:'Korea, Republic of',value:'115'},{name:'Kuwait',value:'116'},{name:'Kyrgyzstan',value:'117'},{name:'Lao, People\'s Democratic Republic',value:'118'},{name:'Latvia',value:'119'},{name:'Lebanon',value:'120'},{name:'Lesotho',value:'121'},{name:'Liberia',value:'122'},{name:'Libyan Arab Jamahiriya',value:'123'},{name:'Liechtenstein',value:'124'},{name:'Lithuania',value:'125'},{name:'Luxembourg',value:'126'},{name:'Macau',value:'127'},{name:'Macedonia, The Former Yugoslav Republic of',value:'128'},{name:'Madagascar',value:'129'},{name:'Malawi',value:'130'},{name:'Malaysia',value:'131'},{name:'Maldives',value:'132'},{name:'Mali',value:'133'},{name:'Malta',value:'134'},{name:'Marshall Islands',value:'135'},{name:'Martinique',value:'136'},{name:'Mauritania',value:'137'},{name:'Mauritius',value:'138'},{name:'Mayotte',value:'139'},{name:'Mexico',value:'140'},{name:'Micronesia, Federated States of',value:'141'},{name:'Moldova, Republic of',value:'142'},{name:'Monaco',value:'143'},{name:'Mongolia',value:'144'},{name:'Montserrat',value:'145'},{name:'Morocco',value:'146'},{name:'Mozambique',value:'147'},{name:'Myanmar',value:'148'},{name:'Namibia',value:'149'},{name:'Nauru',value:'150'},{name:'Nepal',value:'151'},{name:'Netherlands',value:'152'},{name:'Netherlands Antilles',value:'153'},{name:'New Caledonia',value:'154'},{name:'New Zealand',value:'155'},{name:'Nicaragua',value:'156'},{name:'Niger',value:'157'},{name:'Nigeria',value:'158'},{name:'Niue',value:'159'},{name:'Norfolk Island',value:'160'},{name:'Northern Mariana Islands',value:'161'},{name:'Norway',value:'162'},{name:'Oman',value:'163'},{name:'Pakistan',value:'164'},{name:'Palau',value:'165'},{name:'Panama',value:'166'},{name:'Papua New Guinea',value:'167'},{name:'Paraguay',value:'168'},{name:'Peru',value:'169'},{name:'Philippines',value:'170'},{name:'Pitcairn',value:'171'},{name:'Poland',value:'172'},{name:'Portugal',value:'173'},{name:'Puerto Rico',value:'174'},{name:'Qatar',value:'175'},{name:'Reunion',value:'176'},{name:'Romania',value:'177'},{name:'Russian Federation',value:'178'},{name:'Rwanda',value:'179'},{name:'Saint Kitts and Nevis',value:'180'},{name:'Saint Lucia',value:'181'},{name:'Saint Vincent and the Grenadines',value:'182'},{name:'Samoa',value:'183'},{name:'San Marino',value:'184'},{name:'Sao Tome and Principe',value:'185'},{name:'Saudi Arabia',value:'186'},{name:'Senegal',value:'187'},{name:'Seychelles',value:'188'},{name:'Sierra Leone',value:'189'},{name:'Singapore',value:'190'},{name:'Slovakia (Slovak Republic)',value:'191'},{name:'Slovenia',value:'192'},{name:'Solomon Islands',value:'193'},{name:'Somalia',value:'194'},{name:'South Africa',value:'195'},{name:'South Georgia and the South Sandwich Islands',value:'196'},{name:'South Sudan',value:'197'},{name:'Spain',value:'198'},{name:'Sri Lanka',value:'199'},{name:'St. Helena',value:'200'},{name:'St. Pierre and Miquelon',value:'201'},{name:'Sudan',value:'202'},{name:'Suriname',value:'203'},{name:'Svalbard and Jan Mayen Islands',value:'204'},{name:'Swaziland',value:'205'},{name:'Sweden',value:'206'},{name:'Switzerland',value:'207'},{name:'Syrian Arab Republic',value:'208'},{name:'Taiwan, Province of China',value:'209'},{name:'Tajikistan',value:'210'},{name:'Tanzania, United Republic of',value:'211'},{name:'Thailand',value:'212'},{name:'Togo',value:'213'},{name:'Tokelau',value:'214'},{name:'Tonga',value:'215'},{name:'Trinidad and Tobago',value:'216'},{name:'Tunisia',value:'217'},{name:'Turkey',value:'218'},{name:'Turkmenistan',value:'219'},{name:'Turks and Caicos Islands',value:'220'},{name:'Tuvalu',value:'221'},{name:'Uganda',value:'222'},{name:'Ukraine',value:'223'},{name:'United Arab Emirates',value:'224'},{name:'United Kingdom',value:'225'},{name:'United States',value:'226'},{name:'United States Minor Outlying Islands',value:'227'},{name:'Uruguay',value:'228'},{name:'Uzbekistan',value:'229'},{name:'Vanuatu',value:'230'},{name:'Venezuela',value:'231'},{name:'Vietnam',value:'232'},{name:'Virgin Islands (British)',value:'233'},{name:'Virgin Islands (U.S.)',value:'234'},{name:'Wallis and Futuna Islands',value:'235'},{name:'Western Sahara',value:'236'},{name:'Yemen',value:'237'},{name:'Yugoslavia',value:'238'},{name:'Zambia',value:'239'},{name:'Zimbabwe',value:'240'}],this.makeResponse=function(m,n,o){return{response:m,data:{message:n,command:o}}},this.newDate=function(){return new Date().toDateString()},this.isoDate=function(){return new Date().format('isoDate')},this.getIsoDate=function(m){return new Date(m).format('isoDate')},this.toIsoDate=function(m){return m.format('isoDate')},this.dateTime=function(){return new Date().format('dateTime')},this.monthNum=function(){return new Date().format('monthNum')},this.getMonthNum=function(m){return new Date(m).format('monthNum')},this.toMonthNum=function(m){return m.format('monthNum')};//* MONTHS ARRAY
var l=['January','February','March','April','May','June','July','August','September','October','November','December'];this.month_array=l,this.month_o_array=[{id:0,name:'January'},{id:1,name:'February'},{id:2,name:'March'},{id:3,name:'April'},{id:4,name:'May'},{id:5,name:'June'},{id:6,name:'July'},{id:7,name:'August'},{id:8,name:'September'},{id:9,name:'October'},{id:10,name:'November'},{id:11,name:'December'}],this.ajax=function(m,n,o){return $.ajax({method:m||'POST',url:n,data:o})},this.getJSON=function(m){return $.getJSON(m)},this.cgi=function(m,n,o){return $.ajax({method:m||'GET',url:n,data:o,dataType:'jsonp'})},this.loadify=function(m,n){return new Promise(function(o,p){var q=UIkit.modal.blockUI('<center><i style="color:blue;" class="fa fa fa-spinner fa-pulse fa-5x fa-fw"></i></center>'+(n?'<center><br>'+n+'</center>':''));m&&!isNaN(m)?setTimeout(function(){q.hide(),o(!0)},m):o(q)})},this.alert=function(m,n,o){return UIkit.modal.alert('<font color="#1976D2" style="font-weight:bold;text-transform:uppercase;">'+(m||'Notice')+'</font>\n            <hr>\n            <center>'+(n||'</center><font color=red font-weight=bold; font-size=2em>Oops!</font><br>False alarm!<center>')+'</center>'),o&&'function'==typeof o?Promise.resolve(o()):Promise.resolve(!0)},this.confirm=function(m,n,o){return new Promise(function(p){UIkit.modal.confirm('<font color="#1976D2" style="font-weight:bold;text-transform:uppercase;">'+(m||'Confirmation required.')+'</font>\n                <hr>\n                <center>'+n+'</center>',function(){o&&'function'==typeof o?p(o()):p(!0)})})},this.prompt=function(m,n,o,p){return new Promise(function(q){UIkit.modal.prompt('<font color="#1976D2" style="font-weight:bold;text-transform:uppercase;">'+(m||'Info required')+'</font>\n            <hr>\n            '+(n||'email')+' :',o||'',function(s){p&&'function'==typeof p?q(p()):q(!0)})})},this.isemail=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/,this.isEmail=function(m){return _this.isemail.test(m)},this.isusername=/^[a-z0-9_-]{4,16}$/,this.isUsername=function(m){return _this.isusername.test(m)},this.ispassword=/^[-@./\!\$\%\^|#&,+\w\s]{6,50}$/,this.isPassword=function(m){return _this.ispassword.test(m)},this.isnumber=/^-{0,1}\d*\.{0,1}\d+$/,this.isNumber=function(m){return _this.isnumber.test(m)},this.istelephone=/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im,this.isTelephone=function(m){return _this.istelephone.test(m)},this.isdateTime=/^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[012])-(19|20)[0-9]{2} (2[0-3]|[0-1][0-9]):[0-5][0-9]$/,this.isDateTime=function(m){return _this.isdate.test(m)},this.matches=function(m,n){return m===n},this.num2month=function(m){return!isNaN(m)&&11>=m?l[m]:'Invalid Month'},this.unique=function(m){if(!Array.isArray(m))return j('Could not remove duplicates from a non array object','danger'),m;//* create a new array
var n=[];//* loop through the entire length of the provided array
for(var o=m.length-1;0<=o;o--){//* loop through the array once more (for re-verification)
for(var p=m.length-1;0<=p;p--)m[o]==m[p]&&o!=p&&delete m[p];;//* store the relevant values
void 0!=m[o]&&n.push(m[o])};//* return the reversed array (to avoid distortion from the initial)
return n.reverse()},this.removeDuplicates=this.unique,this.count=function(m,n){var o=0;for(v in n)m===n[v]&&(o+=1);return o},this.str=function(m){return'object'==('undefined'==typeof m?'undefined':_typeof(m))?JSON.stringify(m):m},this.json=function(m){return'object'==('undefined'==typeof m?'undefined':_typeof(m))?m:JSON.parse(m)},this.md5=function(m){return /^[a-f0-9]{32}$/gm.test(m)?m:CryptoJS.MD5(m).toString()}}])//The BASIC sms sending application service
.service('sms',['app',function(c){var _this2=this;this.server={},this.server.host='41.89.162.252:3000',this.socket=io.connect('http://'+this.server.host);var g=this.socket;//@ SEND EXPRESS SMS'
this.SMS=function(h){return g.emit('sendSMS',h),Promise.resolve(!0)},this.oneSMS=function(h,j,l){var m;return m=Array.isArray(h)?h:{telephone:h,message:j,password:l},g.emit('sendSMS',m),Promise.resolve(!0)},this.bulkSMS=function(h,j,l){return new Promise(function(m,n){var o=[];//* Ensure that the API key has been set
l?Array.isArray(h)?(h.forEach(function(p){c.isTelephone(p)?o.push({telephone:p,message:j,apiKey:l}):$scope.app.alert('<font style=\'weight:bold;color:red;\'>Invalid telephone number encountered</font>','<center>Could not send an SMS message to the invalid number '+p+'.</center>')},_this2),g.emit('sendSMS',o),m(!0)):$scope.app.alert('<font style=\'weight:bold;color:red;\'>Bulk SMS error.</font>','<center>You can only use the bulk SMS service with an array of telephone contacts</center>'):$scope.app.alert('<font style=\'weight:bold;color:red;\'>ERROR</font>','<center>Failed to instantiate the SMS sending service before api Key definition.</center>')})}}]).service('cgi',[function(){this.ajax=function(c){return $.ajax({method:'GET',url:'/php/index.php',data:c})}}]).run(['app','cgi','$rootScope','$state','$localStorage','sms',function(c,g,h,j,l,m){h.location=j,h.storage=l,h.app=c,h.cgi=g,h.frame={},h.sms=m,h.frame.path=function(){return j.absUrl().split('/#/')[0]+'/#/'+j.absUrl().split('/#/')[1].split('#')[0]},h.frame.relocate=function(n){console.log('Relocating to: #'+n),h.location.go(n)},h.frame.is_admin=!1,h.frame.isAdmin=function(){return!!h.frame.is_admin},h.frame.isRoot=function(){return!(0!=h.storage.admin.access)},h.frame.changeAdmin=function(n){h.frame.is_admin=n},h.frame.reset=function(){delete h.storage.admin,delete h.storage.user,h.frame.changeAdmin(!1),window.location='/#/'}}]).controller('framifyController',['$scope','$state','$rootScope',function(c,g,h){c.current={},c.ui={},h.nav=[],h.links=[],c.nav.hasFilters=!1,c.openFilters=function(l){c.nav.hasFilters=!0!==l},h.app.reinit=function(){c.location.path('/framify')},h.exec=function(l){return l()},h.secure=function(l){var m=window.location.href.split('/'),n=m[m.length-1];0<=c.links.indexOf(n)&&h.exec(l)},c.add={},c.fetch={},c.fetched={},c.counted={},c.data={},c.data.login={},c.data.admin={},h.frame.changeAdmin(!1),c.logedin=!1,c.add=function(l,m,n,o){return new Promise(function(p,q){m=m?c.app.json(m):{},m.command='add',m.table=l==void 0?'':l.toString().replace(/vw_/ig,''),m.token=m.token||c.storage.admin._,m.extras=m?m.extras?m.extras.replace(/LIMIT 1/ig,''):void 0:void 0,n&&n.split(',').forEach(function(s){m[s]=c.app.md5(m[s])}),c.cgi.ajax(m).then(function(s){if(s=c.app.json(s),200==s.response)c.app.notify('<center> '+s.data.message+'</center>','success'),c.fetch(l,{specifics:m.specifics}),c.data[l.toString().replace(/vw_/ig,'')]={},o&&'function'==typeof o?p(o(s)):p(!0);else{// POSTGRESQL ERROR FORMAT MATCHING
if(Array.isArray(s.data.message)){var t=s.data.message[2].match(/DETAIL:(.*)/);s.data.message=void 0!=t||null!=t?t[1]:s.data.message[2]}c.app.notify('<center>'+s.data.message+'</center>','danger'),q(c.app.makeResponse(500,t[1]))}c.$apply()})})},c.update=function(l,m,n,o){return new Promise(function(p,q){m=m?c.app.json(m):{},m.command='update',m.table=l==void 0?'':l.toString().replace(/vw_/ig,''),m.token=m.token||c.storage.admin._,m.extras=m?m.extras?m.extras.replace(/LIMIT 1/ig,''):void 0:void 0,n&&n.split(',').forEach(function(s){m[s]=c.app.md5(m[s])}),c.cgi.ajax(m).then(function(s){if(s=c.app.json(s),200==s.response)c.app.notify('<center> '+s.data.message+'</center>','success'),c.fetch(l,{specifics:m.specifics}),c.data[l.toString().replace(/vw_/ig,'')]={},c.$apply(),'function'==typeof o?p(o(s)):p(!0);else{// POSTGRESQL ERROR FORMAT MATCHING
if(Array.isArray(s.data.message)){var t=s.data.message[2].match(/DETAIL:(.*)/);s.data.message=void 0!=t||null!=t?t[1]:s.data.message[2]}c.app.notify('<center>'+s.data.message+'</center>','danger'),q(c.app.makeResponse(500,s.data.message))}})})};//! BASIC DATA FETCHING
var j=function j(l,m,n){return new Promise(function(o,p){m=m?c.app.json(m):{},m.command='get',m.table=l,console.log('\nprocessing the fetching of table '+l+'\n'),n&&n.split(',').forEach(function(q){m[q]=c.app.md5(m[q])}),c.cgi.ajax(m).then(function(q){if(q=c.app.json(q),200==q.response)c.fetched[l]=q.data.message,c.$apply(),o(q);else{// POSTGRESQL ERROR FORMAT MATCHING
if(Array.isArray(q.data.message)){var s=q.data.message[2].match(/DETAIL:(.*)/);q.data.message=void 0!=s||null!=s?s[1]:q.data.message[2]}c.app.notify('<center>'+q.data.message+'</center>','danger'),p(c.app.makeResponse(500,q.data.message))}})})};c.fetch=function(l,m,n,o){if(Array.isArray(l)){var _ret=function(){var p=[];return l.filter(function(q){return'undefined'!=typeof q[0]}).forEach(function(q,s){p.push(j(q[0],q[1]||{}),n)}),p=p.filter(function(q){return'undefined'!=typeof q}),{v:Promise.all(p)}}();if('object'==('undefined'==typeof _ret?'undefined':_typeof(_ret)))return _ret.v}else return Promise.resolve(j(l,m,n))},c.del=function(l,m,n,o){return new Promise(function(p,q){m=m?c.app.json(m):{},m.command='del',m.table=l==void 0?'':l.toString().replace(/vw_/ig,''),m.token=m.token||c.storage.admin._,n&&n.split(',').forEach(function(s){m[s]=c.app.md5(m[s])}),c.cgi.ajax(m).then(function(s){if(s=c.app.json(s),200==s.response)c.app.notify('<center>'+s.data.message+'</center>','success'),q(s);else{// POSTGRESQL ERROR FORMAT MATCHING
if(Array.isArray(s.data.message)){var t=s.data.message[2].match(/DETAIL:(.*)/);s.data.message=void 0!=t||null!=t?t[1]:s.data.message[2]}c.app.notify('<center>'+s.data.message+'</center>','danger'),p(c.app.makeResponse(500,s.data.message))}c.$apply()})})},c.login=function(l){return new Promise(function(m,n){l&&(c.data.login[l]=c.app.md5(c.data.login[l])),c.data.login.command='get',c.data.login.table='users',c.data.login.extras=' AND active is true LIMIT 1',c.cgi.ajax(c.data.login).then(function(o){if(c.data.admin.extras='',o=c.app.json(o),200==o.response)0<o.data.message.length&&'object'==_typeof(o.data.message[0])?(o.data.message[0].username==c.data.login.username?(c.storage.user=o.data.message[0],c.logedin=!0):(delete c.storage.user,window.location='/#/'),m()):(delete c.storage.user,c.app.notify('<center>You have entered the wrong login credentials.</center>','danger'));else{// POSTGRESQL ERROR FORMAT MATCHING
if(Array.isArray(o.data.message)){var p=o.data.message[2].match(/DETAIL:(.*)/);o.data.message=void 0!=p||null!=p?p[1]:o.data.message[2]}delete c.storage.user,c.app.notify('<center>'+o.data.message+'</center>','danger'),n(c.app.makeResponse(500,o.data.message))}c.$apply()})})},c.adminLogin=function(l){return new Promise(function(){l&&(c.data.admin[l]=c.app.md5(c.data.admin[l])),c.data.admin.command='get',c.data.admin.table='admins',c.data.admin.extras=' AND active is true LIMIT 1',c.cgi.ajax(c.data.admin).then(function(m){if(c.data.admin.extras='',m=c.app.json(m),200==m.response)0<m.data.message.length&&void 0!=_typeof(m.data.message[0])?m.data.message[0].password===c.data.admin.password?(c.storage.admin=m.data.message[0],c.storage.admin._={},c.storage.admin._.user=m.data.message[0].admin_name,c.storage.admin._.key=m.data.message[0].password,h.frame.changeAdmin(!0),c.$apply(),resolve(m)):(delete c.data.admin,delete c.storage.admin,window.location='/#/admin',resolve(m)):(delete c.data.admin,delete c.storage.admin,c.app.notify('<center>You have entered the wrong login credentials.</center>','danger'),window.location='/#/admin',reject(!1));else{// POSTGRESQL ERROR FORMAT MATCHING
if(Array.isArray(m.data.message)){var n=m.data.message[2].match(/DETAIL:(.*)/);m.data.message=void 0!=n||null!=n?n[1]:m.data.message[2]}delete c.storage.admin,c.app.notify('<center>'+m.data.message+'</center>','danger'),reject(c.app.makeResponse(500,m.data.message))}c.$apply()})})},c.islogedin=function(){return new Promise(function(l,m){c.storage.user?(c.data.login.username=c.storage.user.username,c.data.login.password=c.storage.user.password,c.login(),l(!0)):(c.app.notify('<center>You have no permission to access this content</center>','danger'),m(!1))})},c.logout=function(){return c.islogedin=!1,delete c.storage.user,window.location='/#/',Promise.resolve(!0)},c.redirect=function(l){return window.location=l?l:'/#/framify',Promise.resolve(!0)},c.authorize=function(){return c.storage.admin?(c.data.admin={},c.data.admin.admin_name=c.storage.admin.admin_name,c.data.admin.password=c.storage.admin.password,c.adminLogin()):c.location='/#/admin',Promise.resolve(!0)},c.deauthorize=function(){return delete c.storage.admin,h.frame.changeAdmin(!1),window.location='/#/',Promise.resolve(!0)},c.custom=function(l,m,n,o){return new Promise(function(p,q){m=m?c.app.json(m):{},m.command='custom',m.token=m.token||c.storage.admin._,n&&n.split(',').forEach(function(s){m[s]=c.app.md5(m[s])}),c.cgi.ajax(m).then(function(s){if(s=c.app.json(s),200==s.response)c.app.notify('<center>'+(s.data.message||'Successful')+'</center>','success'),c.cFetched[l]=s.data.message,c.data[l.toString().replace(/vw_/ig,'')]={},c.$apply(),p(s);else{// POSTGRESQL ERROR FORMAT MATCHING
if(Array.isArray(s.data.message)){var t=s.data.message[2].match(/DETAIL:(.*)/);s.data.message=void 0!=t||null!=t?t[1]:s.data.message[2]}c.app.notify('<center>'+s.data.message+'</center>'),q(c.app.makeResponse(500,s.data.message))}c.$apply()})})},c.count=function(l,m,n,o){return new Promise(function(p,q){m=m?c.app.json(m):{},m.table=l,m.command='count',m.token=m.token||{},n&&n.split(',').forEach(function(s){m[s]=c.app.md5(m[s])}),c.cgi.ajax(m).then(function(s){if(s=c.app.json(s),200==s.response)c.counted[l.toString().replace(/vw_/ig,'')]=s.data.message,c.data[l.toString().replace(/vw_/ig,'')]={},c.$apply(),p(s);else{// POSTGRESQL ERROR FORMAT MATCHING
if(Array.isArray(s.data.message)){var t=s.data.message[2].match(/DETAIL:(.*)/);s.data.message=void 0!=t||null!=t?t[1]:s.data.message[2]}c.app.notify('<center>'+s.data.message+'</center>','danger'),q(c.app.makeResponse(500,s.data.message))}c.$apply()})})},c.sort=function(l){c.sortKey=l,c.reverse=!c.reverse},c.sanitize=function(l,m){if(m)return m.split(',').forEach(function(n){delete l[n]}),Promise.resolve(l)},c.dPush=function(l,m,n){l[m]=n},c.currmoin=c.app.monthNum(),c.setMoin=function(l){c.currmoin=l},c.addExtras=function(l,m,n,o){return new Promise(function(p,q){l=l||{},m=m||{},n=n||'',o=o||'';var s='',t=[],u=[];//@ CAPTURE THE REMOVE KEYS
o=o.split(',').filter(function(y){return y}),o.forEach(function(y){m[y]=null,delete m[y]}),n.split(',').forEach(function(y,z){var A=y.split(':');t[z]=A[0],u[z]=A[1]});//@ GET THE DEFINED KEYS
var w=Object.keys(m);//@ REPLACE THE DEFINED WITH THE DESIRED REPLACE KEYS
t.forEach(function(y,z){-1!=w.indexOf(y)&&(m[u[z]]=m[y],m[y]=null,delete m[y])}),t=Object.keys(m),u=null,t.forEach(function(y,z){s+=' '+y+'=\''+m[y]+'\' AND'}),t=null,l.extras=s.replace(/AND+$/,''),p(l)})}}]).directive('contenteditable',function(){return{restrict:'A',require:'ngModel',link:function link(c,g,h,j){function l(){j.$setViewValue(g.html())}j.$render=function(){g.html(j.$viewValue||'')},g.bind('blur keyup change',function(){c.$apply(l)})}}});